---
title: "Recap Exercise #2"
output:
  rmarkdown::html_document:
  header-includes:
    - \usepackage{amsmath}
    - \usepackage{bm}
    - \renewcommand{\vec}[1]{\mathbf{#1}}
    - \renewcommand{\mat}[1]{\mathbf{#1}}
    - \newcommand{\exp}[1]{\mathrm{e}^{#1}}
    - \DeclareMathOperator*{\argmin}{arg\,min}
    - \DeclareMathOperator*{\float}{fl}
---

***

This recap exercise provides a formative assessment of your understanding of the course material. No collaboration is allowed. Please work on your own. Once you complete your first attempt and receive written feedback, you can seek support from the TAs and professor if you want, but please continue not to collaborate with peers. Any/all work you turn in should be your own work. Whether intentional or unintentional, any potential violations of academic integrity will be referred to the Honor Committee.

***

Load necessary packages:

```{r message = FALSE}
library(pracma)
library(expm)
library(tidyverse)
```

### Problem 1

Consider the bell curve function, also known as the normal distribution:

$$
f(x) = \frac{1}{\sqrt{2\pi}} \mathrm{e}^{-\frac{1}{2}x^2}
$$

In probability and statistics, it's crucial to be able to integrate this function, and yet, the function has no closed-form anti-derivative. Use polynomial interpolation with 7 equally-spaced nodes to approximate the function $f(x)$ on the interval $x \in [-1.96,1.96]$. Then integrate the polynomial exactly (not using R's `integrate` function, which does a numerical integral similar to a Riemann sum) in order to come up with an estimate of the definite integral of $f(x)$ on that interval. (If you want, you can use R to perform the exact integration by manipulation the polynomial coefficients.) Calculate the relative error as compared to the true answer, which to seven decimal places, is 0.9500042.

### Problem 1 Solution

Your solution goes here.

### Problem 2

Let's investigate how some positioning systems might work. While walking the woods, I started at the location $(0,0)$ and a short while later, I got lost. Luckily I have a device that lets me compute the distances between my location and various communication towers. Suppose that the distance between my unknown location $(u, v)$ and the tower located at position $(p_i, q_i)$, $i=1,\ldots 20$, is estimated as $\sigma_i$. This gives me a system of nonlinear equations:

$$
\sqrt{(u-p_i)^2+(v-q_i)^2} = \sigma_i.
$$

Since I assume that I am not too far from my original location of $(0,0)$, I am going to Taylor expand the left hand equations around $(0,0)$, yielding the linear system

$$
\sqrt{p_i^2 + q_i^2} - \frac{p_i u + q_i v}{\sqrt{p_i^2+q_i^2}} = \sigma_i.
$$

Due to my linearization and to measurement errors in the distances $\sigma_i$, I can't solve these equations exactly. For the $p_i, q_i, \sigma_i$ data defined below, find the best estimate of my location.

```{r cache = TRUE}
p <- c(0, -16, 20, -17, -28, 11, 19, 23, 12, 6, 27, -6, -5, -4, -26, 17, -3, -22, -2, 4)
q <- c(-4, -6, 7, -10, -16, 10, 16, -5, 0, -15, -1, -25, 12, -23, -9, 24, 8, 22, -14, 3)
sigma <- c(7.82, 9.9, 12.33, 11.79, 14.7, 6.59, 4.68, 6.14, 0.16, 2.76, 12.64, 3.47, 3.59, 1.15, 3.69, 10.98, 12.71, 7.46, 5.82, 3.7)
```

### Problem 2 Solution

Your solution goes here.

### Problem 3

Let's use linear algebra to carry out an important task in signal processing. In the figure below is a plot of discrete-time signal. The signal $\mathbf{y}$ is a sequence of 1001 voltage measurements taken at times $k=0,1,\ldots,1000$. There is a code block below (which, by design, won't print when you knit this document) that pre-loads for you a data frame called `signal` that contains this data. Since the measurements were taken with an oscilloscope, they include measurement noise. Your objective in this problem is to remove the noise and smooth out the signal.

```{r echo = FALSE}
signal <- NULL
signal$k <- 0:1000
signal$y <- c(40.67536014, 42.33721862, 40.09043196, 41.465425, 39.76840366, 
38.40533399, 39.47473453, 40.92801652, 39.3206301, 44.90869345, 
39.99416749, 38.77811506, 40.58024841, 38.69112918, 40.40383315, 
40.04557257, 37.03038544, 39.83795208, 36.83459252, 39.01346291, 
39.23582257, 36.45697895, 40.28483038, 38.39344626, 37.05434437, 
39.58726027, 39.67666095, 38.99584922, 36.96599477, 40.69026376, 
36.28719064, 37.03401152, 36.20261168, 35.55734089, 34.158703272, 
35.19221707, 35.18608656, 36.98926127, 35.09201034, 34.190080521, 
33.149371521, 34.988608689, 35.68046456, 33.802330169, 30.487261857, 
31.635818002, 34.199625405, 31.512941098, 29.229654844, 30.257571003, 
32.129992598, 29.7109672, 31.787158877, 31.735109045, 27.854742799, 
30.169889318, 28.276733472, 29.061403333, 27.365940434, 24.303131541, 
24.721564687, 24.631451372, 28.375617528, 23.153606319, 24.963311793, 
25.874679551, 24.924982396, 23.88778085, 22.781212004, 24.52601112, 
23.733668527, 22.241005775, 24.427191343, 24.313310845, 19.961679212, 
21.31571322, 20.401267258, 19.889102311, 23.060744855, 20.160077526, 
18.815916576, 18.319633125, 18.445348046, 19.849136983, 17.232627887, 
18.245584576, 18.295611168, 16.604792982, 18.374802301, 15.860481426, 
16.511783451, 14.40259238, 13.25424537, 16.04732922, 15.321579868, 
14.61852795, 16.723620586, 16.058132825, 16.186028464, 13.63726761, 
16.078475254, 14.75551048, 15.450479044, 14.88546093, 13.88439512, 
13.18066727, 13.4216744, 13.82624766, 13.02833817, 15.453167796, 
15.016685814, 12.73715743, 14.07414383, 12.61876658, 11.1283887, 
12.29093039, 14.71638564, 11.92528669, 12.35744628, 15.900792558, 
12.93770816, 12.61154288, 12.94010513, 16.269723879, 12.54508262, 
14.01205916, 14.54486173, 14.23695393, 14.16670967, 13.13901216, 
15.028721171, 14.96706277, 13.78461824, 15.32165214, 16.370184726, 
15.238439354, 17.360469948, 14.86731762, 14.60229497, 17.664699568, 
14.8290554, 15.938212443, 14.80560599, 17.653594856, 16.33870315, 
14.95869787, 17.466570159, 18.103913104, 18.81331258, 18.200777246, 
19.026098978, 22.704253139, 18.822111912, 19.752861501, 16.749561953, 
20.903483895, 19.044956294, 19.919363472, 23.68133025, 20.722959578, 
22.277703038, 24.490712444, 21.867040231, 22.389223026, 23.542200327, 
22.553848638, 24.408383782, 23.022413789, 24.233821411, 25.881956253, 
26.205908398, 27.225410061, 23.896552045, 25.400770433, 24.077448272, 
26.122879317, 27.653384327, 29.492459859, 25.679563443, 26.962668902, 
26.515947821, 31.576616108, 27.766245962, 30.263289222, 31.276418743, 
29.026858294, 29.720462123, 33.15601306, 29.065695299, 31.768567738, 
30.161129588, 31.331499439, 30.390741891, 29.569709181, 30.033562463, 
31.996498204, 32.647873646, 31.797263246, 34.533832104, 33.482213722, 
34.395838196, 32.460272732, 31.661294371, 29.979502693, 34.700344545, 
33.107149001, 33.583801101, 33.641197351, 36.09352086, 36.12629895, 
35.36729323, 38.4869532, 34.374254724, 33.613974816, 33.777171191, 
35.02119959, 34.835469897, 32.297768984, 35.37643242, 37.1909591, 
36.30521091, 36.05895916, 34.152675415, 36.20894534, 37.07516748, 
34.617558413, 34.870127434, 31.757411836, 36.51636535, 33.459827022, 
35.56513353, 34.226002721, 32.713589666, 35.83900364, 34.247279268, 
33.301954332, 30.379882255, 34.940653283, 36.10538787, 33.462334414, 
31.644986827, 33.252088716, 35.25471789, 32.103390134, 32.690400709, 
33.264218139, 32.510653308, 31.503491953, 31.003789453, 32.09399558, 
34.109249821, 30.179699401, 32.628112658, 33.406612279, 30.453781287, 
32.068348668, 28.413190723, 31.369440214, 29.221179447, 29.563419771, 
27.947452099, 27.766203308, 26.170777099, 25.712068168, 30.644198555, 
26.738237742, 25.517186887, 27.923978733, 25.513703863, 23.276822872, 
25.256344205, 24.938737571, 23.657962471, 27.987075382, 26.171769336, 
25.237305107, 24.84849534, 23.341930024, 25.630995216, 24.446400242, 
22.473431149, 23.962292429, 24.271019478, 25.372406726, 20.570762105, 
23.529056784, 23.515173009, 22.257828478, 21.035568976, 19.238631691, 
20.403680177, 20.087365908, 19.367077504, 20.76088234, 18.752779144, 
16.879395398, 21.775251672, 19.498482547, 15.062052394, 19.802848829, 
18.160017198, 17.21689368, 20.742518231, 17.779845859, 16.420569169, 
17.015048079, 15.927077268, 16.084382551, 16.610030884, 18.095116432, 
15.467423968, 13.84292672, 16.405650435, 16.808874239, 17.053338105, 
15.793007793, 15.859439807, 13.99326617, 13.76222713, 17.794362777, 
15.621814505, 16.240365477, 16.118438554, 14.43509515, 17.076322728, 
16.730000131, 18.26735608, 18.797365052, 15.704897585, 16.81638116, 
16.48144359, 15.992260809, 12.7173548, 14.0388723, 15.630993109, 
17.381910211, 14.93811086, 14.76334238, 16.116362833, 15.781143272, 
13.66361044, 12.54806557, 18.472778427, 15.996045632, 15.896241233, 
15.798966886, 14.6262938, 13.98306544, 17.747220081, 15.011043521, 
14.94479422, 16.616791088, 17.807250674, 16.587873713, 17.640437064, 
17.376380682, 17.698111029, 19.409950087, 17.339039074, 16.350330637, 
15.153633791, 19.290029474, 19.19804872, 18.596667448, 19.909613162, 
17.633061803, 19.084422555, 17.424898354, 19.251878653, 19.885077036, 
17.601274652, 17.09125457, 19.050788428, 19.56468347, 21.903826369, 
20.508814022, 20.557898446, 22.284796021, 21.727867514, 19.480538914, 
19.672785448, 20.627380758, 22.597334291, 20.062346767, 23.449204123, 
21.977055244, 22.34268181, 24.178671434, 25.731030192, 22.936366941, 
20.21191599, 22.730620354, 22.692510077, 26.578883141, 22.988406607, 
25.652202248, 27.606002289, 20.990634945, 26.212954579, 25.901768324, 
27.394977449, 22.992429442, 24.58952332, 27.817525694, 25.866762291, 
23.733657762, 25.634207461, 28.019143092, 23.326570325, 25.586724401, 
24.472718772, 26.835611409, 25.269185445, 25.076977628, 25.031594318, 
23.9515903, 24.649589633, 24.133923505, 27.726144727, 26.674206826, 
24.86971363, 25.259730413, 26.069347573, 24.431098064, 28.065621306, 
26.306962844, 26.416082433, 25.663460735, 27.637675928, 26.092378727, 
27.541211048, 27.023831676, 27.239762197, 28.748037925, 24.535244244, 
25.847857045, 25.19388082, 27.306571319, 24.807135854, 26.344222812, 
25.820147151, 25.090795717, 24.780268949, 25.347106442, 29.412040093, 
28.312163852, 23.110614952, 25.435270904, 24.25753435, 26.435335491, 
27.26737455, 26.524591073, 23.78600562, 23.83810094, 27.193639537, 
26.868202123, 26.511677171, 21.689980928, 27.023732679, 23.804973578, 
26.158496683, 29.69396386, 22.350385916, 26.09689842, 26.598925888, 
23.922006047, 21.778407422, 21.204449671, 25.023330609, 24.396634927, 
21.469021289, 23.883446091, 24.543161938, 24.329289649, 26.813044107, 
25.745786522, 26.616404858, 21.872361314, 27.472745587, 23.987686979, 
24.264425637, 26.319478668, 23.610051479, 24.18322224, 25.17193819, 
23.97186311, 25.050997519, 24.955478381, 25.140111107, 25.873679563, 
24.293698846, 22.670508795, 21.663419928, 22.555173142, 23.706663039, 
21.626095928, 24.756842163, 24.581746954, 24.496891315, 25.274572187, 
25.406370469, 25.89787965, 24.162476972, 23.789915298, 24.999655517, 
26.080861214, 23.214341751, 24.888711275, 20.947492113, 26.927954763, 
24.740631932, 24.405557881, 26.562679138, 23.976029364, 26.800739984, 
27.826613299, 26.73869792, 23.466250309, 26.999218316, 26.966880607, 
26.911680137, 29.337985828, 27.42395728, 29.84059403, 29.248245405, 
27.383056445, 28.176429352, 31.206902633, 27.223563555, 26.212919177, 
32.298351269, 29.561262747, 31.069141969, 31.379133299, 33.774410075, 
29.533387588, 29.045994937, 29.519548474, 29.145229115, 27.834870231, 
28.933552702, 29.119487698, 35.89444682, 33.33149187, 34.467353146, 
31.672287851, 31.829066517, 33.105714483, 32.446703056, 35.30548054, 
36.36369078, 33.665743659, 35.36490356, 33.569659835, 32.642801952, 
36.97289589, 33.347761439, 35.20599923, 37.07801449, 36.90660788, 
38.08235081, 36.64786483, 36.6552324, 38.9057007, 36.93817522, 
38.53108228, 36.99252353, 38.85765113, 39.30095996, 37.12202648, 
41.04199294, 37.11565852, 38.35904878, 35.98560199, 39.55345382, 
40.01449829, 40.4204086, 39.98833601, 40.06841811, 39.56898241, 
38.81646114, 39.69942432, 40.42639404, 40.34953371, 38.78090761, 
36.29408903, 40.05252606, 39.55836798, 39.65920538, 38.74088182, 
37.77257097, 41.72982803, 42.38531149, 40.90784382, 41.84542281, 
39.40772278, 36.2856787, 40.28012645, 39.19944489, 39.76698924, 
42.76897394, 39.57627966, 39.9558866, 40.34380719, 40.15452379, 
38.55848758, 38.78400929, 38.76691414, 40.70030871, 39.02987462, 
36.13438966, 40.22700696, 36.69028878, 39.09542893, 36.99166588, 
36.98344919, 35.76038072, 37.44079875, 34.620572002, 33.274840966, 
35.7016122, 36.11317598, 34.528532427, 35.24985096, 35.64838221, 
33.396822332, 31.780244344, 33.437166375, 36.30265876, 32.516698752, 
31.409507369, 35.55487384, 32.95323224, 30.682915009, 33.36658015, 
28.042626562, 29.559842136, 27.573317475, 28.316877032, 30.17076966, 
29.730786503, 27.764974894, 27.247571473, 27.680713137, 27.032412713, 
27.97406231, 27.544864094, 24.833866704, 28.226902447, 25.040277543, 
24.882074871, 21.687094128, 23.818282422, 22.218732019, 23.09388214, 
24.879429048, 21.886589556, 21.273422169, 22.308084215, 19.325127641, 
17.173321826, 17.781435068, 14.78425944, 20.643117097, 16.956460349, 
17.482823536, 14.93747239, 17.945495989, 15.666022677, 17.767346116, 
17.096638528, 16.128737751, 14.2743305, 13.55786244, 15.18054093, 
12.39005826, 10.45847761, 11.72501854, 12.53974727, 12.52188082, 
11.92822011, 12.63921462, 11.97482897, 9.14003928, 10.52470846, 
8.80903674, 10.1255788, 8.16303597, 10.56526224, 4.93145167, 
7.03777086, 5.9359484, 6.58996515, 10.43811114, 5.25093093, 7.1255338, 
6.06156119, 3.7836318, 5.27259668, 4.93671932, 4.29859786, 4.22788495, 
5.97901306, 2.97400022, 2.69410214, 5.0660163, 2.23775906, 2.71573847, 
4.28900128, 8.11355562, 4.43639477, 4.75680646, 4.9672548, 4.91266943, 
5.65408536, 2.4712814, 3.3166014, 5.45050172, 3.82631269, 5.3524187, 
4.13070279, 2.7140097, 5.17554253, 5.17897694, 1.74148718, 3.51642598, 
5.87317909, 5.8663236, 4.87837291, 9.60087754, 3.6955447, 4.91049165, 
7.87031029, 4.45570503, 4.88115315, 7.1862, 7.27541168, 7.61315154, 
8.30177043, 7.6098306, 6.91056417, 8.58173612, 8.33093084, 10.57874858, 
12.3494222, 9.86086409, 8.98321719, 9.30040726, 12.83468704, 
11.28769234, 12.56940007, 10.42092296, 11.66438209, 14.51427406, 
10.64273041, 15.160475081, 14.51647456, 16.624991211, 16.955599478, 
15.839151584, 16.884365714, 16.564126548, 15.342939224, 18.206228131, 
17.838944193, 18.725142027, 19.778168143, 17.161107573, 16.199384098, 
19.333759807, 18.262847122, 19.026563333, 20.070550543, 23.700777458, 
23.201018608, 23.903702109, 23.774242604, 22.710176411, 20.310769694, 
24.537074373, 24.703045411, 22.445614563, 25.744411437, 27.714043701, 
25.355768435, 24.774420428, 25.652975484, 26.425407147, 24.327470081, 
27.093871084, 27.592582264, 30.720758399, 29.500527937, 28.186301176, 
29.200604186, 29.947371231, 30.139868126, 34.233729184, 30.155657315, 
30.743703473, 30.221863765, 29.643694605, 34.955921473, 32.782493269, 
31.899510368, 37.03750316, 32.591972512, 35.40624324, 37.08323421, 
33.761667023, 36.19842117, 37.65338356, 33.444402931, 34.026261966, 
38.66719447, 37.10797974, 39.46683705, 37.01188675, 36.34049564, 
33.793730561, 34.833199181, 35.04159752, 36.33120711, 37.25048246, 
37.89584833, 36.70932465, 37.98925914, 37.4735939, 37.27207424, 
35.51234433, 39.87559687, 37.83374448, 37.37969245, 35.10819528, 
37.73747349, 35.90296419, 38.78574813, 35.68725498, 36.43878624, 
37.97669039, 36.52597614, 38.0712481, 35.67071425, 35.27296048, 
41.02765853, 38.13665316, 35.84975401, 36.2195216, 39.38425708, 
33.503695124, 35.93685458, 36.51439755, 36.28898789, 35.51784298, 
36.94897016, 35.1330941, 37.13071645, 32.270366405, 35.54208428, 
34.951672986, 32.944753367, 37.52592255, 37.02673074, 33.056846534, 
34.959475096, 34.514933912, 36.88312463, 33.750970907, 35.1854353, 
34.773266785, 34.969479899, 34.367177549, 33.99382216, 32.811761387, 
32.246653041, 31.408582161, 31.614033543, 32.666013526, 31.18248479, 
30.343403048, 29.996130663, 33.011953471, 31.097270397, 29.278594738, 
28.538920544, 27.625149274, 30.311102369, 28.293368138, 26.161301569, 
29.885901272, 27.999546162, 26.603805727, 27.030661939, 26.229782706, 
27.781201001, 26.375586649, 28.834269805, 27.135148338, 26.886463481, 
29.192535394, 26.951131883, 25.763136899, 25.154946626, 27.93254426, 
26.327901552, 25.62886215, 26.023656085, 25.597340752, 26.67233184, 
26.612830214, 24.270264185, 24.776501836, 26.645166912, 26.863804726, 
24.459514348, 26.291171567, 25.084284618, 23.48222095, 22.767499422, 
21.82606473, 25.881735479, 22.837833776, 24.970343685, 23.898885806, 
23.713043113, 22.55839671, 26.519427255, 24.181424138, 23.455974254, 
21.947378201, 25.87133735, 26.350030219, 23.106179206, 22.352243853, 
21.197851477, 23.125212441, 23.666085931, 23.796193851, 25.600341946, 
25.770219788, 23.463966443, 24.47107069, 24.344604424, 25.47358963, 
23.681859298, 25.297616975, 24.902744542, 23.505429972, 24.387041568, 
21.399838072, 26.461420761, 21.936569918, 26.749378321, 25.020259112, 
27.040729647, 26.375444488, 24.323222087, 23.850992459, 24.32431015, 
26.972228565, 25.645432009, 25.796607568, 23.341701366, 27.315998955, 
26.293556498, 26.163085526, 25.752183214, 26.168048616, 28.574856746, 
23.922515607, 28.081493908, 23.724993713, 27.745093563, 26.749342779, 
26.960669042, 25.926563554, 26.206719709, 26.715200837, 26.792830852, 
25.328715042, 26.295239653, 27.407577305, 29.356269378, 25.191029631, 
26.799363327, 25.837461811, 29.618287762, 28.431882873, 27.219126966, 
28.898988945, 31.108248026, 29.081153472, 25.913437793, 30.472479654, 
28.108442672, 31.272900179, 28.039782696, 28.784220988, 29.822706897, 
29.627657523, 27.961901692)
```

```{r}
plot(signal$k,signal$y,type="l")
```

We can do this as follows. Let $\mathbf{y} \in \mathbb{R}^{1001}$ be the vector of noisy measurements at times $k=0,1,\ldots,1000$. Then we want to solve the following optimization problem:

$$
z_* = \mathrm{argmin}_{z \in \mathbb{R}^{1001}} \left\{\sum_{k=0}^{1000} (z_k-y_k)^2 + \lambda \sum_{k=1}^{1000} (z_k-z_{k-1})^2 \right\}.
$$

This optimization problem tries to accomplish two different objectives, simultaneously:

* The new signal $\mathbf{z}$ should still be close to the noisy signal $\mathbf{y}$, as measured by the sum of the squared differences between $z_k$ and $y_k$ (the first term).
* The new signal $\mathbf{z}$ should be smooth in the sense that it doesn't change too quickly, as measured by the sum of the squared differences between consecutive signal terms $z_k$ and $z_{k-1}$ (the second term).

The parameter $\lambda$ trades off the importance between these two objectives. If you set $\lambda$ to be very small, then the new signal $\mathbf{z}$ should be very close to $\mathbf{y}$. If you set $\lambda$ to be very large, then the new signal $\mathbf{z}$ should be extremely smooth, but perhaps farther away from the original signal $\mathbf{y}$.

Since this is a minimization problem, it's (probably) overdetermined. Look at the equation given above and take each term separately. The first term is trying to minimize the sum of $(z_k - y_k)^2$. Note this is the dot product of $\mathbf{z}-\mathbf{y}$ with itself. It will be minimized when $\mathbf{z} = \mathbf{y}$. The second term is trying to minimize the sum of $\lambda(z_k - z_{k-1})^2$. This is the dot product of $\sqrt{\lambda}\mathbf{M}\mathbf{z}$ with itself, for an appropriate matrix $\mathbf{M}$. This term will be minimized when $\sqrt{\lambda}\mathbf{M}\mathbf{z} = 0$.

To recap, we have two problems to solve simultaneously:

$$
\mathbf{z}=\mathbf{y}
$$

and

$$
\sqrt{\lambda}\mathbf{M}\mathbf{z} = 0
$$

This is an overdetermined system. Use a least squares approach to solve the problem for $\lambda=1$, $\lambda=100$, and $\lambda=1000$. Plot your three de-noised signals and the original signal on one graph and state which value of $\lambda$ you think is best for balancing smoothness and accuracy (just from looking at your graph).

### Problem 3 Solution

Your solution goes here.

### Problem 4

![](https://github.com/chadtopaz/computational-linear-algebra/raw/main/recap/chutes_ladders.png){width=50%}

Board game time! Let's model a variant of the Chutes and Ladders game as a Markov chain. We'll analyze some of the game dynamics assuming there is just one player. Here are some more details of the movement rules on the game board shown above.

In this variant of the game, there is only one player. This player roles a three-sided die each turn, which yields the possible values of 0, 1, or 2, each with probability equal to one third. The player starts at square 1, and moves the number of spaces rolled on the die. The direction of movement is according to the order indicated in the top left corner of each square. For example, if the player starts on square 5 and rolls a 2, they end up on square 7. If they roll a 0, they stay on square 5.

If the player's roll leads to a space that is the bottom of the ladder, they are instantaneously transferred to the top of the ladder. For example, if they start on square 5 and roll a 1, they end the turn on square 15.

On the other hand, if the player's roll leads to a space that is the top of a chute, they instantaneously fall to the bottom of the slide. For example, if they start on square 7 and roll a 2, they end the turn on square 3.

Once they reach square 20, they stay there and the game is over. If the player rolls 2 while starting on square 19, they move to square 20 and the game is over.

a\. Compute the probability that after 20 turns the player has reached the end (square 20).

b\. Now let's change the board slightly and add a chute from square 20 back to square 1, so the game never ends! (If you roll a 2 on 19, you also go back to square 1.) You play the game for a very long time (e.g., while you are contemplating the beauty of linear algebra), and then I walk into the room. On which square am I most likely to find you, and what is the probability of being there?

### Problem 4 Solution

a\. Your solution goes here.

b\. Your solution goes here.

### Problem 5

Here is some data about life expectancy in various countries in Africa, estimated every 5 years from 1952 to 2007:

```{r}
lifeexpectancy <- read.csv("https://goo.gl/BtBnPg", header = T) %>%
  filter(continent %in% c("Africa")) %>%
  select(country, year, lifeExp) %>%
  pivot_wider(names_from = year, names_prefix = "lifeExp", values_from = lifeExp)
```

a\. Perform a principal component analysis on this data and plot the data in the space of the first two principal components (with labels as country names). What proportion of the variance in the data do the first two principal components capture?

b\. Note that Zimbabwe and Senegal have similar values for the first principal component coordinate and quite different values for the second principal component coordinate. By looking at the loadings (the rotation matrix) and remembering that PCA does a change of basis, interpret the difference between these two countries in terms of life expectancy.

### Problem 5 Solution

a\. Your solution goes here.

b\. Your solution goes here.